// Source - https://stackoverflow.com/questions/30511579/linux-sc-phys-pages-not-working-on-mac-os-x
// Posted by jxh, modified by community. See post 'Timeline' for change history
// Retrieved 2025-11-13, License - CC BY-SA 4.0

#define PHYS_PAGES get_phys_pages()

unsigned get_phys_pages () {
    static unsigned phys_pages;
    if (phys_pages == 0) {
        #if USE_SYSCTL_HW_MEMSIZE
            uint64_t mem;
            size_t len = sizeof(mem);
            sysctlbyname("hw.memsize", &mem, &len, NULL, 0);
            phys_pages = mem/sysconf(_SC_PAGE_SIZE);
        #elif USE_SYSCONF_PHYS_PAGES
            phys_pages = sysconf(_SC_PHYS_PAGES);
        #else
        #   error "no way to get phys pages"
        #endif
    }
    return phys_pages;
}

--------------

// Source - https://stackoverflow.com/questions/30511579/linux-sc-phys-pages-not-working-on-mac-os-x
// Posted by jxh, modified by community. See post 'Timeline' for change history
// Retrieved 2025-11-13, License - CC BY-SA 4.0

#include <iostream>
#include <stdint.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/sysctl.h>

int main () {
    size_t pagesz = sysconf(_SC_PAGE_SIZE);
    uint64_t mem;
    size_t len = sizeof(mem);
    sysctlbyname("hw.memsize", &mem, &len, NULL, 0);
    std::cout << mem << '\n';
    std::cout << mem/pagesz << '\n';
    std::cout << mem/1024/1024/1024 << '\n';
}
